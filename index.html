<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AI Farmer Advisory ‚Äî Realistic Demo</title>
<style>
:root {
  --green: #047857;
  --accent: #16a34a;
  --muted: #64748b;
}
body {
  margin:0; font-family: Inter,Segoe UI,Roboto,Arial;
  background: linear-gradient(180deg,#f0fdf4,#ecfccb);
  color:#06313a;
}
header {
  background: var(--green); color:white;
  padding:14px 18px; text-align:center; font-weight:700;
  display:none; /* hidden until login */
}
main {
  max-width: 1000px; margin: 24px auto; padding:20px;
  background:white; border-radius:12px; box-shadow:0 10px 30px rgba(2,6,23,0.06);
  display:none; /* hidden until login */
}
h1 { margin:6px 0 0; font-size:18px; }
.controls { display:flex; gap:12px; flex-wrap:wrap; }
.col { flex:1; min-width:240px; }
label { display:block; margin-top:12px; font-weight:700; }
select,textarea {
  width:100%; padding:10px; margin-top:8px;
  border-radius:8px; border:1px solid #cbd5e0; font-size:15px;
}
.btn {
  background: var(--accent); color:white; border:none;
  padding:10px 14px; border-radius:8px; font-weight:700;
  cursor:pointer; transition: background-color 0.3s, transform 0.15s;
  box-shadow:0 4px 8px rgba(22,163,74,0.3); user-select:none;
}
.btn:hover { background:#0f9d4a; transform:scale(1.05);}
.btn:active { transform:scale(0.97);}
.btn.ghost { background:transparent; border:1px solid rgba(6,49,58,0.08); color:var(--green);}
.btn.ghost:hover { background:#dff3e3; transform:scale(1.05);}
.btn.ghost:active { transform:scale(0.97);}
.response {
  margin-top:18px; padding:16px; border-radius:10px;
  background:#f8fff6; border:1px solid #d1f7dc; white-space:pre-line;
}
.examples { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
.chip {
  background:#e6f6ee; padding:8px 10px; border-radius:999px;
  border:1px solid #c9f0d8; cursor:pointer; user-select:none;
}
.chip:hover { background:#dff3e3; }
.small { font-size:13px; color:var(--muted); }
.footer { font-size:13px; color:var(--muted); text-align:center; margin-top:18px; display:none; /* hidden until login */ }
.section-title { font-weight:800; color:var(--green); margin:10px 0; }

/* Login overlay */
#login-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: linear-gradient(120deg, #a1c4fd, #c2e9fb, #fbc2eb, #a6c1ee);
  background-size: 400% 400%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  animation: gradientBG 10s ease infinite;
  overflow: hidden;
}
@keyframes gradientBG {
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* floating leaves */
.leaf {
  position: absolute;
  width: 40px; height: 40px;
  opacity: 0.8;
  animation: floatLeaf linear infinite;
}
@keyframes floatLeaf {
  0% {transform: translateY(0) rotate(0deg);}
  100% {transform: translateY(100vh) rotate(360deg);}
}

#login-box {
  background: white;
  padding: 30px;
  border-radius: 12px;
  text-align: center;
  max-width: 400px;
  width: 90%;
  box-shadow: 0 8px 24px rgba(0,0,0,0.25);
}
#login-box h2 { margin-bottom:14px; color:var(--green);}
#login-box input {
  width:100%; padding:10px; margin-top:8px; margin-bottom:12px;
  border-radius:8px; border:1px solid #cbd5e0; font-size:15px;
}

/* Welcome overlay */
#welcome-overlay {
  position:fixed; top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.65);
  display:flex; align-items:center; justify-content:center;
  z-index:1000;
}
#welcome-box {
  background:white; padding:30px; border-radius:12px;
  text-align:center; max-width:400px;
  box-shadow:0 8px 24px rgba(0,0,0,0.25);
}
#welcome-box h2 { margin:0 0 14px; font-size:20px; color:var(--green);}
#welcome-box img { width:120px; margin-bottom:15px; }
</style>
</head>
<body>

  <!-- LOGIN -->
<div id="login-overlay">
  <div id="login-box">
    <h2>üì± Farmer Login</h2>
    <label for="phone">Enter Phone Number</label>
    <input type="text" id="phone" placeholder="Enter number" required pattern="[0-9]{10}">
    <button class="btn" onclick="sendOTP()">Send OTP</button>
    <div id="otp-section" style="display:none;">
      <label for="otp">Enter OTP</label>
      <input type="text" id="otp" placeholder="Enter OTP">
      <button class="btn ghost" onclick="verifyOTP()">Verify OTP</button>
    </div>
  </div>
</div>

<div id="welcome-overlay" style="display: none;">
  <div id="welcome-box">
    <img src="https://tse2.mm.bing.net/th/id/OIP.azG7Um7P7ttgAzVX0fU2tQHaHa?pid=Api&P=0&h=180" alt="Farmer">
    <h2>üë®‚Äçüåæ Helloooo Farmer!!üòÅ</h2>
    <p>Welcome! I will guide you with crop, soil, pest and market advice.</p>
    <button id="enterBtn" class="btn">Hello, I‚Äôm ready to enter</button>
  </div>
</div>

<header>üåæ AI-Style Farmer Advisory ‚Äî Agriculture ¬∑ FoodTech ¬∑ Rural Development</header>
<main id="main-app">
<h1 id="main-title">Ask a question ‚Äî get detailed, practical advisory üåæ</h1> <br><br>
<div class="controls">
  <div class="col">
    <label id="language-label" for="language">Choose Language</label>
    <select id="language">
      <option value="en">English</option>
      <option value="hi">Hindi</option>
      <option value="te">Telugu</option>
      <option value="ur">Urdu</option>
    </select>
    <label id="topic-label" for="topic">Choose Query Type</label>
    <select id="topic">
      <option value="crop">Crop Related</option>
      <option value="soil">Soil & Fertilizer</option>
      <option value="weather">Weather</option>
      <option value="pest">Pest & Disease</option>
      <option value="irrigation">Irrigation</option>
      <option value="market">Market Info</option>
    </select>
    <label id="examples-label" class="small">Quick examples</label>
    <div id="examples" class="examples"></div>
  </div>
  <div class="col">
    <label id="question-label" for="question">Type or speak your question</label>
    <textarea id="question" rows="5" placeholder="E.g. 'Best irrigation for tomato in summer?'"></textarea>
    <div style="margin-top:10px; display:flex; gap:8px; flex-wrap:wrap">
      <button id="askBtn" class="btn">Get Advisory</button>
      <button id="voiceBtn" class="btn ghost">üé§ Speak</button>
      <button id="readBtn" class="btn ghost">üîä Read</button>
      <button id="copyBtn" class="btn ghost">üìã Copy</button>
    </div>
  </div>
</div>
<div id="response" class="response" style="display:none"></div>
<div id="tip-text" class="small" style="margin-top:12px"></div>
</main>
<div id="footer-text" class="footer"></div>

<script>
// original JS fully intact
const languageEl = document.getElementById('language');
const topicEl = document.getElementById('topic');
const examplesEl = document.getElementById('examples');
const qEl = document.getElementById('question');
const responseEl = document.getElementById('response');
const mainTitle = document.getElementById('main-title');
const languageLabel = document.getElementById('language-label');
const topicLabel = document.getElementById('topic-label');
const examplesLabel = document.getElementById('examples-label');
const questionLabel = document.getElementById('question-label');
const tipText = document.getElementById('tip-text');
const footerText = document.getElementById('footer-text');
const askBtn = document.getElementById('askBtn');
const voiceBtn = document.getElementById('voiceBtn');
const readBtn = document.getElementById('readBtn');
const copyBtn = document.getElementById('copyBtn');

let lastPlain = '';
let currentLang = languageEl.value || 'en';

const UItext={
  en:{mainTitle:'Ask a question ‚Äî get detailed, practical advisory',language:'Choose Language',topic:'Choose Query Type',examples:'Quick examples',question:'Type or speak your question',tip:'Tip: Include crop name and short context (soil, season, symptom).',footer:'For real issues, contact your local agriculture officer.',btn:'Get Advisory',questionPlaceholder:"E.g. 'Best irrigation for tomato in summer?'",speakBtn:'üé§ Speak',readBtn:'üîä Read',copyBtn:'üìã Copy',topicOptions:['Crop Related','Soil & Fertilizer','Weather','Pest & Disease','Irrigation','Market Info']},
  hi:{mainTitle:'‡§è‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡•á‡§Ç ‚Äî ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§π‡§æ‡§∞‡§ø‡§ï ‡§∏‡§≤‡§æ‡§π ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç',language:'‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç',topic:'‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç',examples:'‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£',question:'‡§Ö‡§™‡§®‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§¨‡•ã‡§≤‡•á‡§Ç',tip:'‡§¨‡•á‡§π‡§§‡§∞ ‡§∏‡§≤‡§æ‡§π ‡§ï‡•á ‡§≤‡§ø‡§è ‡§´‡§∏‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§',footer:'‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•á ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§ï‡•É‡§∑‡§ø ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§',btn:'‡§∏‡§≤‡§æ‡§π ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç',questionPlaceholder:"‡§â‡§¶‡§æ‡§π‡§∞‡§£: '‡§ü‡§Æ‡§æ‡§ü‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§§‡§∞‡•Ä‡§ï‡§æ?'",speakBtn:'üé§ ‡§¨‡•ã‡§≤‡•á‡§Ç',readBtn:'üîä ‡§∏‡•Å‡§®‡•á‡§Ç',copyBtn:'üìã ‡§ï‡•â‡§™‡•Ä',topicOptions:['‡§´‡§∏‡§≤ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§','‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§î‡§∞ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï','‡§Æ‡•å‡§∏‡§Æ','‡§ï‡•Ä‡§ü ‡§î‡§∞ ‡§∞‡•ã‡§ó','‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à','‡§¨‡§æ‡§ú‡§æ‡§∞ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä']},
  te:{mainTitle:'‡∞í‡∞ï ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞® ‡∞Ö‡∞°‡∞ó‡∞Ç‡∞°‡∞ø ‚Äî ‡∞µ‡∞ø‡∞µ‡∞∞‡∞Æ‡±à‡∞® ‡∞∏‡∞≤‡∞π‡∞æ‡∞≤‡±Å ‡∞™‡±ä‡∞Ç‡∞¶‡∞Ç‡∞°‡∞ø',language:'‡∞≠‡∞æ‡∞∑‡∞®‡±Å ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø',topic:'‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞® ‡∞∞‡∞ï‡∞Ç ‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø',examples:'‡∞§‡±ç‡∞µ‡∞∞‡∞ø‡∞§ ‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£‡∞≤‡±Å',question:'‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞®‡±Å ‡∞ü‡±à‡∞™‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø ‡∞≤‡±á‡∞¶‡∞æ ‡∞Æ‡∞æ‡∞ü‡±ç‡∞≤‡∞æ‡∞°‡±Å',tip:'‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞∏‡∞≤‡∞π‡∞æ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞™‡∞Ç‡∞ü ‡∞™‡±á‡∞∞‡±Å, ‡∞∏‡±Ä‡∞ú‡∞®‡±ç, ‡∞≤‡±á‡∞¶‡∞æ ‡∞≤‡∞ï‡±ç‡∞∑‡∞£‡∞æ‡∞≤‡±Å ‡∞ö‡±á‡∞∞‡±ç‡∞ö‡∞Ç‡∞°‡∞ø.',footer:'‡∞®‡∞ø‡∞ú‡∞Æ‡±à‡∞® ‡∞∏‡∞Æ‡∞∏‡±ç‡∞Ø‡∞≤ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Æ‡±Ä ‡∞∏‡±ç‡∞•‡∞æ‡∞®‡∞ø‡∞ï ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡∞æ‡∞Ø ‡∞Ö‡∞ß‡∞ø‡∞ï‡∞æ‡∞∞‡∞ø‡∞®‡∞ø ‡∞∏‡∞Ç‡∞™‡±ç‡∞∞‡∞¶‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø.',btn:'‡∞∏‡∞≤‡∞π‡∞æ ‡∞™‡±ä‡∞Ç‡∞¶‡∞Ç‡∞°‡∞ø',questionPlaceholder:"‡∞â‡∞¶‡∞æ‡∞π‡∞∞‡∞£: '‡∞ü‡∞Æ‡±ã‡∞ü‡∞æ‡∞ï‡±Å ‡∞â‡∞§‡±ç‡∞§‡∞Æ ‡∞®‡±Ä‡∞∞‡±Å ‡∞é‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å?'",speakBtn:'üé§ ‡∞Æ‡∞æ‡∞ü‡±ç‡∞≤‡∞æ‡∞°‡±Å',readBtn:'üîä ‡∞µ‡∞ø‡∞®‡±ç‡∞®‡±Å‡∞ï‡±ã‡∞Ç‡∞°‡∞ø',copyBtn:'üìã ‡∞ï‡∞æ‡∞™‡±Ä',topicOptions:['‡∞™‡∞Ç‡∞ü ‡∞∏‡∞Ç‡∞¨‡∞Ç‡∞ß‡∞ø‡∞§','‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø & ‡∞é‡∞∞‡±Å‡∞µ‡±Å‡∞≤‡±Å','‡∞µ‡∞æ‡∞§‡∞æ‡∞µ‡∞∞‡∞£‡∞Ç','‡∞ï‡±Ä‡∞ü & ‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø','‡∞∏‡∞ø‡∞Ç⁄Ü‡∞ï‡∞æ ‡∞µ‡∞ø‡∞ß‡∞æ‡∞®‡∞Ç','‡∞Æ‡∞æ‡∞∞‡±ç‡∞ï‡±Ü‡∞ü‡±ç ‡∞∏‡∞Æ‡∞æ‡∞ö‡∞æ‡∞∞‡∞Ç']},
  ur:{mainTitle:'ÿ≥ŸàÿßŸÑ ŸæŸà⁄Ü⁄æ€å⁄∫ ‚Äî ÿ™ŸÅÿµ€åŸÑ€å ÿßŸàÿ± ÿπŸÖŸÑ€å ŸÖÿ¥Ÿàÿ±€Å ÿ≠ÿßÿµŸÑ ⁄©ÿ±€å⁄∫',language:'ÿ≤ÿ®ÿßŸÜ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫',topic:'ÿ≥ŸàÿßŸÑ ⁄©€å ŸÇÿ≥ŸÖ ŸÖŸÜÿ™ÿÆÿ® ⁄©ÿ±€å⁄∫',examples:'ÿ¨ŸÑÿØ€å ŸÖÿ´ÿßŸÑ€å⁄∫',question:'ÿßŸæŸÜÿß ÿ≥ŸàÿßŸÑ ŸÑ⁄©⁄æ€å⁄∫ €åÿß ÿ®ŸàŸÑ€å⁄∫',tip:'ÿ®€Åÿ™ÿ± ŸÖÿ¥Ÿàÿ±€í ⁄©€í ŸÑ€å€í ŸÅÿµŸÑ ⁄©ÿß ŸÜÿßŸÖ ÿßŸàÿ± ŸÖÿÆÿ™ÿµÿ± ÿ≥€åÿßŸÇ ÿ¥ÿßŸÖŸÑ ⁄©ÿ±€å⁄∫€î',footer:'ÿ≠ŸÇ€åŸÇ€å ŸÖÿ≥ÿßÿ¶ŸÑ ⁄©€í ŸÑ€å€í ÿßŸæŸÜ€í ŸÖŸÇÿßŸÖ€å ÿ≤ÿ±ÿπ€å ÿßŸÅÿ≥ÿ± ÿ≥€í ÿ±ÿßÿ®ÿ∑€Å ⁄©ÿ±€å⁄∫€î',btn:'ŸÖÿ¥Ÿàÿ±€Å ÿ≠ÿßÿµŸÑ ⁄©ÿ±€å⁄∫',questionPlaceholder:"ŸÖÿ´ÿßŸÑ: 'ŸπŸÖÿßŸπÿ± ⁄©€í ŸÑ€å€í ÿ®€Åÿ™ÿ±€åŸÜ ÿ¢ÿ®Ÿæÿßÿ¥€å ⁄©ÿ® €Å€íÿü'",speakBtn:'üé§ ÿ®ŸàŸÑ€å⁄∫',readBtn:'üîä ÿ≥ŸÜ€å⁄∫',copyBtn:'üìã ⁄©ÿßŸæ€å',topicOptions:['ŸÅÿµŸÑ ÿ≥€í ŸÖÿ™ÿπŸÑŸÇ','ŸÖŸπ€å ÿßŸàÿ± ⁄©⁄æÿßÿØ','ŸÖŸàÿ≥ŸÖ','⁄©€å⁄ëŸà⁄∫ ÿßŸàÿ± ÿ®€åŸÖÿßÿ±€å','ÿ¢ÿ®Ÿæÿßÿ¥€å','ŸÖÿßÿ±⁄©€åŸπ ⁄©€å ŸÖÿπŸÑŸàŸÖÿßÿ™']}
};

const EXAMPLES={
  crop:["Best variety of rice in summer?","How to increase wheat yield?"],
  soil:["Which fertilizer for cotton?","How to improve sandy soil?"],
  weather:["Is rain expected tomorrow?","Best crops for dry climate?"],
  pest:["How to control bollworm?","Natural remedy for aphids?"],
  irrigation:["Best irrigation for tomato?","Drip vs flood irrigation?"],
  market:["Current price of onions?","Where to sell maize at good price?"]
};

const EXAMPLE_TRANSLATIONS = {
  hi:{ "Best variety of rice in summer?":"‡§ó‡§∞‡•ç‡§Æ‡§ø‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ö‡§æ‡§µ‡§≤ ‡§ï‡•Ä ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ï‡§ø‡§∏‡•ç‡§Æ?","How to increase wheat yield?":"‡§ó‡•á‡§π‡•Ç‡§Ç ‡§ï‡•Ä ‡§â‡§™‡§ú ‡§ï‡•à‡§∏‡•á ‡§¨‡§¢‡§º‡§æ‡§è‡§Ç?","Which fertilizer for cotton?":"‡§ï‡§™‡§æ‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•å‡§® ‡§∏‡§æ ‡§â‡§∞‡•ç‡§µ‡§∞‡§ï?","How to improve sandy soil?":"‡§∞‡•á‡§§‡•Ä‡§≤‡•Ä ‡§Æ‡§ø‡§ü‡•ç‡§ü‡•Ä ‡§ï‡•à‡§∏‡•á ‡§∏‡•Å‡§ß‡§æ‡§∞‡•á‡§Ç?","Is rain expected tomorrow?":"‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§≤ ‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§π‡•ã‡§®‡•á ‡§ï‡•Ä ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§π‡•à?","Best crops for dry climate?":"‡§∏‡•Ç‡§ñ‡•á ‡§Æ‡•å‡§∏‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§∞‡•ç‡§µ‡•ã‡§§‡•ç‡§§‡§Æ ‡§´‡§∏‡§≤‡•á‡§Ç?","How to control bollworm?":"‡§¨‡•â‡§≤‡§µ‡§∞‡•ç‡§Æ ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç?","Natural remedy for aphids?":"‡§è‡§™‡§ø‡§°‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§â‡§™‡§ö‡§æ‡§∞?","Best irrigation for tomato?":"‡§ü‡§Æ‡§æ‡§ü‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à ‡§§‡§∞‡•Ä‡§ï‡§æ?","Drip vs flood irrigation?":"‡§°‡•ç‡§∞‡§ø‡§™ ‡§¨‡§®‡§æ‡§Æ ‡§´‡•ç‡§≤‡§° ‡§∏‡§ø‡§Ç‡§ö‡§æ‡§à?","Current price of onions?":"‡§™‡•ç‡§Ø‡§æ‡§ú ‡§ï‡•Ä ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§ï‡•Ä‡§Æ‡§§?","Where to sell maize at good price?":"‡§Æ‡§ï‡§à ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§ï‡•Ä‡§Æ‡§§ ‡§™‡§∞ ‡§ï‡§π‡§æ‡§Å ‡§¨‡•á‡§ö‡•á‡§Ç?" },
  te:{ "Best variety of rice in summer?":"‡∞µ‡±á‡∞∏‡∞µ‡∞ø‡∞≤‡±ã ‡∞¨‡∞ø‡∞Ø‡±ç‡∞Ø‡∞Ç ‡∞â‡∞§‡±ç‡∞§‡∞Æ ‡∞ú‡∞æ‡∞§‡∞ø?","How to increase wheat yield?":"‡∞ó‡±ã‡∞ß‡±Å‡∞Æ ‡∞â‡∞§‡±ç‡∞™‡∞§‡±ç‡∞§‡∞ø‡∞®‡∞ø ‡∞é‡∞≤‡∞æ ‡∞™‡±Ü‡∞Ç‡∞ö‡∞æ‡∞≤‡∞ø?","Which fertilizer for cotton?":"‡∞™‡∞§‡±ç‡∞§‡∞ø ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞è ‡∞é‡∞∞‡±Å‡∞µ‡±Å?","How to improve sandy soil?":"‡∞Æ‡∞ü‡±ç‡∞ü‡∞ø‡∞®‡∞ø ‡∞é‡∞≤‡∞æ ‡∞Æ‡±Ü‡∞∞‡±Å‡∞ó‡±Å‡∞™‡∞∞‡∞ö‡∞æ‡∞≤‡∞ø?","Is rain expected tomorrow?":"‡∞∞‡±á‡∞™‡±Å ‡∞µ‡∞∞‡±ç‡∞∑‡∞Ç ‡∞µ‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞æ?","Best crops for dry climate?":"‡∞é‡∞Ç‡∞° ‡∞Æ‡±å‡∞∏‡∞Ç‡∞≤‡±ã ‡∞â‡∞§‡±ç‡∞§‡∞Æ ‡∞™‡∞Ç‡∞ü‡∞≤‡±Å?","How to control bollworm?":"‡∞¨‡±ä‡∞≤‡±ç‡∞µ‡∞∞‡±ç‡∞Æ‡±ç ‡∞®‡±Å ‡∞é‡∞≤‡∞æ ‡∞®‡∞ø‡∞Ø‡∞Ç‡∞§‡±ç‡∞∞‡∞ø‡∞Ç‡∞ö‡∞æ‡∞≤‡∞ø?","Natural remedy for aphids?":"‡∞è‡∞´‡∞ø‡∞°‡±ç‡∞∏‡±ç ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞∏‡∞π‡∞ú ‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏?","Best irrigation for tomato?":"‡∞ü‡∞Æ‡±ã‡∞ü‡∞æ‡∞ï‡±Å ‡∞â‡∞§‡±ç‡∞§‡∞Æ ‡∞®‡±Ä‡∞∞‡±Å?","Drip vs flood irrigation?":"‡∞°‡±ç‡∞∞‡∞ø‡∞™‡±ç ‡∞µ‡∞∞‡±ç‡∞∏‡±Ü‡∞∏‡±ç ‡∞´‡±ç‡∞≤‡∞°‡±ç ‡∞á‡∞∞‡±ç‡∞∞‡∞ø‡∞ó‡±á‡∞∑‡∞®‡±ç?","Current price of onions?":"‡∞â‡∞≤‡±ç‡∞≤‡∞ø‡∞™‡∞æ‡∞Ø‡∞≤ ‡∞™‡±ç‡∞∞‡∞∏‡±ç‡∞§‡±Å‡∞§ ‡∞ß‡∞∞?","Where to sell maize at good price?":"‡∞Æ‡∞ï‡±ç‡∞ï‡∞æ‡∞®‡±Å ‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞ß‡∞∞‡∞ï‡±Å ‡∞é‡∞ï‡±ç‡∞ï‡∞° ‡∞Ö‡∞Æ‡±ç‡∞Æ‡∞æ‡∞≤‡∞ø?" },
  ur:{ "Best variety of rice in summer?":"⁄Øÿ±ŸÖ€åŸà⁄∫ ŸÖ€å⁄∫ ⁄ÜÿßŸàŸÑ ⁄©€å ÿ®€Åÿ™ÿ±€åŸÜ ŸÇÿ≥ŸÖÿü","How to increase wheat yield?":"⁄ØŸÜÿØŸÖ ⁄©€å Ÿæ€åÿØÿßŸàÿßÿ± ⁄©€åÿ≥€í ÿ®⁄ë⁄æÿßÿ¶€å⁄∫ÿü","Which fertilizer for cotton?":"⁄©Ÿæÿßÿ≥ ⁄©€í ŸÑ€å€í ⁄©ŸàŸÜ ÿ≥ÿß ⁄©⁄æÿßÿØÿü","How to improve sandy soil?":"ÿ±€åÿ™ŸÑ€å ÿ≤ŸÖ€åŸÜ ⁄©Ÿà ⁄©€åÿ≥€í ÿ®€Åÿ™ÿ± ÿ®ŸÜÿßÿ¶€å⁄∫ÿü","Is rain expected tomorrow?":"⁄©€åÿß ⁄©ŸÑ ÿ®ÿßÿ±ÿ¥ ŸÖÿ™ŸàŸÇÿπ €Å€íÿü","Best crops for dry climate?":"ÿÆÿ¥⁄© ŸÖŸàÿ≥ŸÖ ⁄©€í ŸÑ€å€í ÿ®€Åÿ™ÿ±€åŸÜ ŸÅÿµŸÑ€å⁄∫ÿü","How to control bollworm?":"ÿ®ŸàŸÑŸàÿ±ŸÖ ⁄©Ÿà ⁄©€åÿ≥€í ⁄©ŸÜŸπÿ±ŸàŸÑ ⁄©ÿ±€å⁄∫ÿü","Natural remedy for aphids?":"ÿß€åŸÅ⁄àÿ≤ ⁄©€í ŸÑ€å€í ŸÇÿØÿ±ÿ™€å ÿπŸÑÿßÿ¨ÿü","Best irrigation for tomato?":"ŸπŸÖÿßŸπÿ± ⁄©€í ŸÑ€å€í ÿ®€Åÿ™ÿ±€åŸÜ ÿ¢ÿ®Ÿæÿßÿ¥€åÿü","Drip vs flood irrigation?":"⁄àÿ±€åŸæ ÿ®ŸÖŸÇÿßÿ®ŸÑ€Å ŸÅŸÑ⁄à ÿ¢ÿ®Ÿæÿßÿ¥€åÿü","Current price of onions?":"Ÿæ€åÿßÿ≤ ⁄©€å ŸÖŸàÿ¨ŸàÿØ€Å ŸÇ€åŸÖÿ™ÿü","Where to sell maize at good price?":"ŸÖ⁄©ÿ¶€å ⁄©€Åÿß⁄∫ ÿß⁄Ü⁄æ€å ŸÇ€åŸÖÿ™ Ÿæÿ± ŸÅÿ±ŸàÿÆÿ™ ⁄©ÿ±€å⁄∫ÿü" }
};

function updateUIText(lang){
  const txt = UItext[lang] || UItext.en;
  mainTitle.textContent = txt.mainTitle;
  languageLabel.textContent = txt.language;
  topicLabel.textContent = txt.topic;
  examplesLabel.textContent = txt.examples;
  questionLabel.textContent = txt.question;
  tipText.textContent = txt.tip;
  footerText.textContent = txt.footer;
  qEl.placeholder = txt.questionPlaceholder;
  askBtn.textContent = txt.btn;
  voiceBtn.textContent = txt.speakBtn;
  readBtn.textContent = txt.readBtn;
  copyBtn.textContent = txt.copyBtn;

  topicEl.innerHTML = '';
  txt.topicOptions.forEach((opt,i)=>{
    const option = document.createElement('option');
    option.value = Object.keys(EXAMPLES)[i];
    option.textContent = opt;
    topicEl.appendChild(option);
  });
}

function updateExamples(topic){
  examplesEl.innerHTML='';
  (EXAMPLES[topic]||[]).forEach(ex=>{
    const chip = document.createElement('div');
    chip.className='chip';
    const lang = languageEl.value;
    chip.textContent = EXAMPLE_TRANSLATIONS[lang]?.[ex] || ex;
    chip.onclick = ()=>{ qEl.value = chip.textContent; handleAsk(); };
    examplesEl.appendChild(chip);
  });
}

async function handleAsk(){
  const question=qEl.value.trim();
  if(!question){ alert('Please type a question!'); return; }
  responseEl.style.display='block';
  responseEl.innerHTML='Fetching advisory...';
  try{
    const res = await fetch('/chat',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({message:question,lang:languageEl.value,topic:topicEl.value})
    });
    if(res.ok){
      const data = await res.json();
      const text = (data.reply||'').split('\n').join('\n\n');
      responseEl.innerHTML=text;
      lastPlain=text;
    }
  }catch(e){
    responseEl.innerHTML="‚ö†Ô∏è Failed to fetch advisory.";
    lastPlain="";
  }
}

askBtn.onclick=handleAsk;
copyBtn.onclick=()=>{navigator.clipboard.writeText(lastPlain); alert('Copied!');};
voiceBtn.onclick=()=>{
  const r=new (window.SpeechRecognition||window.webkitSpeechRecognition)();
  const langMap={en:'en-US',hi:'hi-IN',te:'te-IN',ur:'ur-PK'};
  r.lang=langMap[languageEl.value]||'en-US';
  r.start();
  r.onresult=(e)=>{qEl.value=e.results[0][0].transcript; handleAsk();};
};
readBtn.onclick=()=>{
  const u=new SpeechSynthesisUtterance(lastPlain);
  const langMap={en:'en-US',hi:'hi-IN',te:'te-IN',ur:'ur-PK'};
  u.lang=langMap[languageEl.value]||'en-US';
  speechSynthesis.speak(u);
};

languageEl.onchange=()=>{ currentLang=languageEl.value; updateUIText(currentLang); updateExamples(topicEl.value); };
topicEl.onchange=()=>updateExamples(topicEl.value);

updateUIText(currentLang);
updateExamples(topicEl.value);

// OTP Mock
function sendOTP(){
  document.getElementById('otp-section').style.display='block';
  alert("OTP sent (mock)");
}
function verifyOTP(){
  const otp=document.getElementById('otp').value.trim();
  if(otp==="1234"){  // mock OTP
    document.getElementById('login-overlay').style.display='none';
    document.getElementById('welcome-overlay').style.display='flex';
  } else {
    alert("Invalid OTP, try 1234 for demo");
  }
}

document.getElementById('enterBtn').onclick=()=>{
  document.getElementById('welcome-overlay').style.display='none';
  document.getElementById('main-app').style.display='block';
  document.querySelector('header').style.display='block';
  document.querySelector('.footer').style.display='block';
};

// add floating leaves
for(let i=0;i<8;i++){
  const leaf = document.createElement('div');
  leaf.className='leaf';
  leaf.style.left=Math.random()*100+'%';
  leaf.style.animationDuration=(5+Math.random()*5)+'s';
  leaf.style.animationDelay=(Math.random()*5)+'s';
  document.getElementById('login-overlay').appendChild(leaf);
}
</script>
</body>
</html>
